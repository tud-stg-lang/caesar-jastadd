<testsuite name="Test contracts with virtual classes"
	package="contracts.vc">

	<compile-check-error id="vc001" 
						 error="VIRTUAL_WITH_REQ"
						 description="Virtual classes cannot have requirements">
		<code>
			// Define contract
			public abstract cclass ContractA {
				public abstract String a();
			}
			
			// Virtual class with requirement
			public cclass family {
				public cclass VirtualClientA requires ContractA {}
			}
		</code>
	</compile-check-error>

	<compile-run id="vc002"
			 	 description="abstract virtual classes don't belong to contract">
		<code>

			public abstract cclass ContractFamilyA {
				public abstract cclass VirtualClass1 {
					public abstract String a();
				}	
			}

			public cclass ProvA extends ContractFamilyA {}

        </code>
        
        <test>
        	ContractFamilyA ca = new ProvA();	
        </test>
        
	</compile-run>
	
		<compile-run id="vc003"
			 	 description="fulfilled required virtual classes">
		<code>

			public cclass ProvA {
				public cclass A {
					public String s;
					
					public A(String s){
						this.s = s;
					}
				}	
			}
			
			public cclass UserA requires ProvA {
				public A createA(){
					return new A("a"); 
				}
			}
			
			public cclass CompleteA extends UserA &amp; ProvA {}

        </code>
        
        <test>
			CompleteA ca = new CompleteA();
			
			assertEquals(ca.createA().s, "a");	
        </test>
        
	</compile-run>
	
	<compile id="vc004"
			 	 description="fulfilled required virtual classes">
		<code>
			public abstract cclass A {
			    public abstract cclass Y { }	
			}
			
			public abstract cclass E extends A {
				public cclass X extends Y {}
			}
			
			public abstract cclass F extends A {
				public abstract cclass Y {
					public abstract void m();
				}
			}
			
			public cclass B requires E &amp; F {
				public cclass X {
					public void n() { m(); }
				}
			}
        </code>
        
	</compile>
		
</testsuite>